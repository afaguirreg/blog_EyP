<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8">
		<title>Documento sin título</title>
		<link rel="stylesheet" type="text/css" href="../0 - styles/mystyles.css">
		<script language="JavaScript" src="../0 - scripts/myscripts.js"></script>
	</head>

	<body>
		<div class="Normal" style="text-align:justify">
			<b><i>Diseño de Interfaces para automatización con C# y Mfg Advanced HMI Controls</i></b>
			<br><br>
			Crear un nuevo proyecto, agregar y modificar las propiedades de los controles necesarios para obtener una interfaz visual similar a la mostrada en la imagen.
		  <br><br>
			<div align="center"><img src="img/2.9_1.png" alt="" width="auto" height="auto"></div>
			<br>
			Sugerencia: probar modificando el valor de las propiedades y verificando si cambia el aspecto visual de los controles, por ejemplo, color y tamaño de texto.
			<br><br>
			Puede descargar la librería de controles y utilizarlas para diseñar esta interfaz:
			<br><br>
			<a href="https://drive.google.com/uc?id=1o19RIH7GxKLQsAuE4TOSZdqP4yhxpC-w&export=download&authuser=0" target="_blank">https://drive.google.com/uc?id=1o19RIH7GxKLQsAuE4TOSZdqP4yhxpC-w&amp;export=download&amp;authuser=0</a>
			<br><br>
			<b><i>Nota</i></b>: Copiar el archivo descargado <b><i>MfgControl.AdvancedHMI.Controls.dll</i></b> a la unidad C: \ del sistema.
			<br><br>
			Como instalar la librería de controles
			<br><br>
			<div align="center">
				<video controls controlslist="nodownload" preload="preload" loop>
					<source src="video/4 - AdvancedHMI.webm" type="video/webm">
				</video>
			</div>
			<br>
			Es posible que se requiera la re-configuración de la plataforma .NET para poder ejecutar la aplicación desarrollada con la librería de controles.
			<br><br>
			<div align="center">
				<video controls controlslist="nodownload" preload="preload" loop>
					<source src="video/5 - Configuración.webm" type="video/webm">
				</video>
			</div>
			<br><br>
			<b><i>Añadiendo código a la aplicación</i></b>
			<br><br>
			La configuración de la interface visual de la aplicación nos permite establecer el aspecto que tendrá el programa para el usuario final, pero detrás de ésta  hay un código que define el &ldquo;comportamiento&rdquo; del programa, que es la manera en que procesa la información y controla cuando debe hacerlo.
			<br><br>
			<b><i>Eventos</i></b>
			<br><br>
			Un evento es un mensaje que envía un objeto cuando ocurre una acción. La acción podría ser causada por la interacción del usuario, como un clic del botón, o podría ser iniciado por otra lógica de programa, como cambiar un valor de propiedad.
			<br>
			El uso más habitual para los eventos se produce en las interfaces gráficas; normalmente, las clases que representan controles de la interfaz disponen de eventos que se notifican cuando el usuario hace algo con el control (por ejemplo, hacer clic en un botón).
			<br><br>
			El objeto que provoca el evento se conoce como <b><i>emisor del evento</i></b>. El evento normalmente es un miembro del emisor del evento; por ejemplo, el evento <b><i>Click</i></b> es un miembro de la clase <b><i>Button</i></b>.
			<br><br>
			Los eventos, sin embargo, no sólo se utilizan para interfaces gráficas. Los eventos proporcionan un medio apropiado para que los objetos puedan señalizar cambios de estado que pueden resultar útiles para los clientes de ese objeto. Los eventos constituyen unidades importantes para crear clases que se pueden reutilizar en diferentes programas.
			<br><br>
			En una aplicación de formularios Windows Forms en C# típica, se suscribe a eventos generados por controles como botones, cajas de texto y cuadros de lista. Puede utilizar el entorno de desarrollo integrado (IDE) de C# para examinar los eventos que publica un control y seleccionar los que desea controlar. El IDE agrega automáticamente un método de control de eventos vacío y el código para suscribirse al evento.
			<br><br>
			Para acceder a la lista de eventos de un control se debe seleccionar y hacer click en el ícono <b><i>events</i></b> de la ventana <b><i>Properties</i></b>.
			<br><br>
			<div align="center"><img src="img/2.9_2.png" alt="" width="auto" height="auto"></div>
			<br>
			Cada objeto tiene múltiples eventos que se pueden programar individualmente para definir el comportamiento del programa ante una acción determinada. El evento <b><i>Load</i></b> ocurre cuando se ejecuta el programa y se despliega el objeto <b><i>MainForm</i></b>.
			<br><br>
			Programar el evento <b><i>Load</i></b> del objeto <b><i>MainForm</i></b> para establecer las configuraciones y estado inicial de algunas propiedades de los objetos ubicados en el proyecto:
			<br><br>
		  <div align="center"><img src="img/2.9_3.png" alt="" width="auto" height="auto"></div>
			<br>
			Como puede ver, el uso de los eventos es muy intuitivo. Para lograr que el programa se comporte tal y como usted desea, debe definir claramente cuando y como desea que ocurran las acciones de control sobre las variables y objetos.
			<br><br>
			El evento <b><i>Click</i></b> ocurre cuando el objeto <b><i>pushButton</i></b> detecta que se ha pulsado el botón izquierdo del mouse sobre él.
			<br><br>
			Para éste caso se ha programado que el control <b><i>pushButton1</i></b> active <b><i>waterPump1</i></b> y <b><i>pneumaticValve1</i></b> y <b><i>pushButton2</i></b> activará <b><i>waterPump2</i></b> y <b><i>pneumaticValve2</i></b>, lo cual ejecutará una animación de cambio de color en estos objetos.
			<br>
			<br>
			<div align="center"><img src="img/2.9_4.png" alt="" width="auto" height="auto"></div>
			<br>
			Continuando con nuestro proyecto, vamos a declarar las variables que almacenarán el valor numérico del estado del proceso.
			<br><br>
			<div align="center"><img src="img/2.9_5.png" alt="" width="auto" height="auto"></div>
			<br><br>
			<b><i>Objeto Timer</i></b>
			<br><br>
			El objeto Timer permite ejecutar tareas repetitivas en un intervalo de tiempo definido.
			<br><br>
			Para comprobar su funcionamiento vamos a desarrollar el código para establecer el valor de las variables del proceso en la aplicación.
			<br><br>
			Ubicar el objeto Timer en la ventana de proyecto.
			<br><br>
			<div align="center"><img src="img/2.9_6.png" alt="" width="auto" height="auto"></div>
			<br>
			En las propiedades del control <b><i>timer1</i></b> hallaremos la propiedad <b><i>enabled</i></b> que permite habilitar el evento de ocurrencia a intervalos regulares y la propiedad <b><i>interval</i></b> que permite definir el tiempo de intervalo en milisegundos (100 ms = 0,1 segundo)
			<br><br>
			El objeto <b><i>timer1</i></b> se encargará de monitorear las variables durante el proceso de llenado del depósito y el proceso de vaciado corresponderá al objeto <b><i>timer2</i></b>.
			<br><br>
			La habilitación de estos objetos se programó en el evento <b><i>Click</i></b> de <b><i>pushButton1</i></b> y <b><i>pushButton2</i></b>.
			<br><br>
			En el evento <b><i>Tick</i></b> del control <b><i>timer1</i></b> escribiremos las instrucciones necesarias para asignar el valor de las variables al objeto corespondiente.
			<br><br>
			<div align="center"><img src="img/2.9_7.png" alt="" width="auto" height="auto"></div>
			<br><br>
			<b><i>Estructura condicional if</i></b>
			<br><br>
			Esta estructura permite la ejecución de una instrucción o de un bloque de instrucciones si se cumple una condición (El resultado es Falso o Verdadero).
			Generalmente se utilizan operaciones lógicas y relacionales para establecer el resultado de la condición.
			<br><br>
			Apliquemos su principio a nuestro proyecto.
			<br><br>
			<div align="center"><img src="img/2.9_8.png" alt="" width="auto" height="auto"></div>
			<br>
			Proyecto en funcionamiento:
			<br><br>
			<div align="center">
				<video controls controlslist="nodownload" preload="preload" loop>
					<source src="video/Proyecto.webm" type="video/webm">
				</video>
			</div>
			<br><br>
			<b><i>Sonidos</i></b>
			<br><br>
			En ocasiones puede resultar útil reproducir sonidos en nuestra aplicación.
			<br><br>
			Adicionaremos a nuestro proyecto el código necesario para darle la capacidad de reproducir un sonido de alarma cuando el nivel llegue a un valor determinado.
			<br><br>
			Agregar las siguientes líneas:
			<br><br>
			<div align="center"><img src="img/2.9_9.png" alt="" width="auto" height="auto"></div>
			<br>
			<div align="center"><img src="img/2.9_10.png" alt="" width="auto" height="auto"></div>
			<br>
			Programar el evento <b><i>Tick</i></b> del objeto <b><i>Timer3</i></b> con las siguientes líneas de código:
			<br><br>
			<div align="center"><img src="img/2.9_11.png" alt="" width="auto" height="auto"></div>
			<br>
			Descargar el archivo de sonido alarma.wav y copiar a la unidad D:\ del sistema
			<br><br>
			<a href="https://drive.google.com/uc?id=1UzDoCVI98DLq8IGNZjmozOFGFjPtA14J&amp;export=download&amp;authuser=0" target="_blank">https://drive.google.com/uc?id=1UzDoCVI98DLq8IGNZjmozOFGFjPtA14J&amp;export=download&amp;authuser=0</a>
			<br><br>
			<div align="center">
				<video controls controlslist="nodownload" preload="preload" loop>
					<source src="video/10 - Alarma.m4v" type="video/mp4">
				</video>
			</div>
			<br><br>
			<b><i>Almacenar registro de variables en un archivo</i></b>
			<br><br>
			Los sistemas de monitoreo por computador son aplicaciones de software diseñadas con la finalidad de controlar y supervisar procesos y permiten al usuario recolectar datos de una o más instalaciones distribuidas y/o enviar comandos y órdenes a estas instalaciones. Además, envían la información generada en el proceso productivo a diversos usuarios, tanto del mismo nivel como hacia otros supervisores dentro de la empresa, es decir, que permite la participación de otras áreas como, por ejemplo:
			<br><br>
			Control de calidad, supervisión, mantenimiento, etc.
			<br><br>
			Vamos a desarrollar la programación para que nuestra aplicación adquiera la característica de poder almacenar en un archivo el estado de las variables por intervalos de tiempo, de manera que se pueda verificar su comportamiento a través del tiempo.
			<br><br>
			Incluir los espacios System.IO y System.Text como muestra la imagen.
			<br><br>
			<div align="center"><img src="img/2.9_13.png" alt="" width="auto" height="auto"></div>
			<br>
			Programar el evento <b><i>Tick</i></b> del objeto <b><i>Timer4</i></b> con las siguientes líneas de código:
			<br><br>
			<div align="center"><img src="img/2.9_14.png" alt="" width="1000" height="auto"></div>
			<br>
			La instrucción crea un nuevo FileStream, que abre la conexión con el archivo especificado en el primer parámetro.
			<br><br>
			La Línea de datos a almacenar debe contener las variables en formato de cadena de texto separadas por punto y coma &ldquo;;&rdquo;, esto permite que cada dato se almacene en una celda diferente en el archivo.
			<br><br>
			El formato de archivo almacenado es CSV.
			<br><br>
			Los archivos CSV (del inglés comma-separated values) son un tipo de documento en formato abierto sencillo para representar datos en forma de tabla, en las que las columnas se separan por punto y coma.
			<br><br>
			Ejecutar el programa por un periodo de tiempo y después cerrarlo para verificar los datos almacenados.
			<br><br>
			<b><i>Nota importante</i></b>: El archivo de registro debe estar cerrado al momento de ejecutar la aplicación, ya que si está abierto nuestro programa no podrá escribir datos en él.
			La ruta donde se guardará el archivo es D:\Registro.csv
			<br><br>
			Al abrir nuevamente el archivo Registro.csv encontraremos los datos recolectados durante el lapso de tiempo que el programa estuvo ejecutándose.
			<br><br>
			<div align="center"><img src="img/2.9_15.png" alt="" width="auto" height="auto"></div>
			<br><br>
			<b><i>Crear una ventana Splash Screen</i></b>
			<br><br>
			Una ventana Splash Screen es aquella que se despliega por unos segundos cuando se inicia un programa.
			<br><br>
			Para crear una ventana Splash Screen en nuestro proyecto, vamos a agregar un nuevo ítem como muestra la imagen:
			<br><br>
			<div align="center"><img src="img/2.9_16.png" alt="" width="auto" height="auto"></div>
			<br>
			Seleccionamos el ítem Form y le damos el nombre Splash Screen.cs
			<br><br>
			<div align="center"><img src="img/2.9_17.png" alt="" width="auto" height="auto"></div>
			<br>
			Agregamos un control Timer a la ventana Splash Screen:
			<br><br>
			<div align="center"><img src="img/2.9_18.png" alt="" width="auto" height="auto"></div>
			<br>
			En las propiedades del control Timer habilitamos el control con la función enabled = true y definimos el intervalo de tiempo en milisegundos (3000ms = 3 segundos)
			<br><br>
			<div align="center"><img src="img/2.9_19.png" alt="" width="auto" height="auto"></div>
			<br>
			Podemos configurar el aspecto de la ventana de acuerdo con el proyecto desarrollado, definiendo imagen, color, texto, etc.
			<br><br>
			<div align="center"><img src="img/2.9_20.png" alt="" width="auto" height="auto"></div>
			<br>
			<div align="center"><img src="img/2.9_21.png" alt="" width="auto" height="auto"></div>
			<br>
			Finalmente, adicionamos código al evento <b><i>Tick</i></b> del control <b><i>Timer1</i></b> para definir el comportamiento deseado (ocultar la ventana Splash Screen y mostrar la siguiente ventana cuando hayan transcurrido 3 segundos).
			<br><br>
			<div align="center"><img src="img/2.9_22.png" alt="" width="auto" height="auto"></div>
			<br>
			Hacer doble click en Program.cs, en el explorador de proyectos y nos aseguramos de que el objeto inicial del proyecto será la nueva ventana Splash Screen:
			<br><br>
			<div align="center"><img src="img/2.9_23.png" alt="" width="auto" height="auto"></div>
			<br>
			Podemos configurar una nueva ventana para cumplir la función de login de usuario:
			<br><br>
			<div align="center"><img src="img/2.9_24.png" alt="" width="auto" height="auto"></div>
			<br>
			Para establecer si el usuario y contraseña ingresados son válidos vamos a programar el evento Click del control Button1
			<br><br>
			<div align="center"><img src="img/2.9_25.png" alt="" width="auto" height="auto"></div>
			<br>
			Cuando se ejecuta el evento Click del control Button1 y se comprueba que el usuario y la contraseña son válidos, nos lleva a una nueva ventana donde se verá la interface gráfica del proyecto.
		</div>
	</body>
</html>